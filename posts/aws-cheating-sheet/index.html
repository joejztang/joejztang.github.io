<!doctype html><html lang=en><head><title>aws cheating sheet · 130l</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="130l"><meta name=description content="Before anything, amazon always set minimum permissions generally.

  region and availability zone
  
    
    Link to heading
  


A region is a physical location in the world which combines two or more availability zones.
zone is one or more discrete data centers each with redundant power networking connectivity housed in
edge locations are endpoints for AWS which are used for caching content. like cloudflare and other CDN services.
vpc(virtual private cloud): a networking service which is a logically isolated section of the AWS Cloud where you can launch AWS resources in a virtual network


  IAM (identity administrating management)
  
    
    Link to heading
  


IAM is universal
root account is the account created when first setup the aws console, it has the admin access
no users have permission when first created
new users are assigned Access Key ID & Secret Access Keys when first created
Access Key ID & Scret Access Keys are used to programaticaly access AWS console, and they only got viewed Once.
always setup multi factor authentication (MFA) on your root account
you can create you only password rotation policy and many other policies.


  IAM roles
  
    
    Link to heading
  

aws doesn&rsquo;t recommend using aws_access_key_id and aws_secret_access_key to use aws command line.
it&rsquo;s much more secure to use IAM roles"><meta name=keywords content="blog,science,technology,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="aws cheating sheet"><meta name=twitter:description content="Before anything, amazon always set minimum permissions generally.
region and availability zone Link to heading A region is a physical location in the world which combines two or more availability zones. zone is one or more discrete data centers each with redundant power networking connectivity housed in edge locations are endpoints for AWS which are used for caching content. like cloudflare and other CDN services. vpc(virtual private cloud): a networking service which is a logically isolated section of the AWS Cloud where you can launch AWS resources in a virtual network IAM (identity administrating management) Link to heading IAM is universal root account is the account created when first setup the aws console, it has the admin access no users have permission when first created new users are assigned Access Key ID & Secret Access Keys when first created Access Key ID & Scret Access Keys are used to programaticaly access AWS console, and they only got viewed Once. always setup multi factor authentication (MFA) on your root account you can create you only password rotation policy and many other policies. IAM roles Link to heading aws doesn’t recommend using aws_access_key_id and aws_secret_access_key to use aws command line. it’s much more secure to use IAM roles"><meta property="og:url" content="https://joejztang.github.io/posts/aws-cheating-sheet/"><meta property="og:site_name" content="130l"><meta property="og:title" content="aws cheating sheet"><meta property="og:description" content="Before anything, amazon always set minimum permissions generally.
region and availability zone Link to heading A region is a physical location in the world which combines two or more availability zones. zone is one or more discrete data centers each with redundant power networking connectivity housed in edge locations are endpoints for AWS which are used for caching content. like cloudflare and other CDN services. vpc(virtual private cloud): a networking service which is a logically isolated section of the AWS Cloud where you can launch AWS resources in a virtual network IAM (identity administrating management) Link to heading IAM is universal root account is the account created when first setup the aws console, it has the admin access no users have permission when first created new users are assigned Access Key ID & Secret Access Keys when first created Access Key ID & Scret Access Keys are used to programaticaly access AWS console, and they only got viewed Once. always setup multi factor authentication (MFA) on your root account you can create you only password rotation policy and many other policies. IAM roles Link to heading aws doesn’t recommend using aws_access_key_id and aws_secret_access_key to use aws command line. it’s much more secure to use IAM roles"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-04-17T15:58:52+00:00"><meta property="article:modified_time" content="2020-04-17T15:58:52+00:00"><link rel=canonical href=https://joejztang.github.io/posts/aws-cheating-sheet/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.4b392a85107b91dbdabc528edf014a6ab1a30cd44cafcd5325c8efe796794fca.css integrity="sha256-SzkqhRB7kdvavFKO3wFKarGjDNRMr81TJcjv55Z5T8o=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/img/favicon.svg sizes=any><link rel=icon type=image/png href=/img/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/img/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://joejztang.github.io/>130l
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Posts</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://joejztang.github.io/posts/aws-cheating-sheet/>aws cheating sheet</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2020-04-17T15:58:52Z>April 17, 2020
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
39-minute read</span></div></div></header><div class=post-content><p>Before anything, amazon always set minimum permissions generally.</p><h2 id=region-and-availability-zone>region and availability zone
<a class=heading-link href=#region-and-availability-zone><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>A region is a physical location in the world which combines two or more availability zones.</li><li>zone is <strong>one or more discrete data centers</strong> each with redundant power networking connectivity housed in</li><li>edge locations are endpoints for AWS which are used for caching content. like cloudflare and other CDN services.</li><li>vpc(virtual private cloud): a networking service which is a logically isolated section of the AWS Cloud where you can launch AWS resources in a virtual network</li></ul><h2 id=iam-identity-administrating-management>IAM (identity administrating management)
<a class=heading-link href=#iam-identity-administrating-management><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>IAM is universal</li><li><code>root account</code> is the account created when first setup the aws console, it has the admin access</li><li>no users have permission when first created</li><li>new users are assigned <strong>Access Key ID & Secret Access Keys</strong> when first created</li><li><strong>Access Key ID & Scret Access Keys</strong> are used to programaticaly access AWS console, and they only got viewed <strong>Once</strong>.</li><li>always setup multi factor authentication (MFA) on your root account</li><li>you can create you only password rotation policy and many other policies.</li></ul><h3 id=iam-roles>IAM roles
<a class=heading-link href=#iam-roles><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>aws doesn&rsquo;t recommend using <code>aws_access_key_id</code> and <code>aws_secret_access_key</code> to use aws command line.
it&rsquo;s much more secure to use IAM roles</p><p>use <code>action</code>&ndash;><code>attach/replace IAM roles</code> to do so.</p><ul><li>roles can be assigned to an EC2 instance after it&rsquo;s created using both the console & command line</li><li>roles are universal - you can use them in any region</li></ul><p><strong>Instance profile</strong> is a constainer for IAM roles. When create a role for EC2, the console automatically createa an instance profile and gives it the same name as the role. When launching EC2 instance, you can select a role to associate with the instance.</p><h3 id=iam-policies>IAM Policies
<a class=heading-link href=#iam-policies><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>IAM Policy is a JSON document that defines permissions. It can be identity policy or resource policy. It contains a list of statements.</p><p>It won&rsquo;t be effective until it got attached.</p><p>example is the following</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;Version&#34;</span>: <span style=color:#a5d6ff>&#34;2012-10-17&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;Statement&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;Sid&#34;</span>: <span style=color:#a5d6ff>&#34;SpecificTable&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;Effect&#34;</span>: <span style=color:#a5d6ff>&#34;Allow&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;Action&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;dynamodb:BatchGet*&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;dynamodb:Get&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f85149>......</span>
</span></span><span style=display:flex><span>      ],
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;Resource&#34;</span>:<span style=color:#a5d6ff>&#34;arn:aws:dynammodb:*:*:table/MyTable&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li><p><code>Sid</code> is human readable id/descriptions</p></li><li><p><code>Effect</code> is either <code>Allow</code> or <code>Deny</code>. Not explicitly allowed is implicit deny; explicitly deny overwrite all the following deny.</p></li><li><p><code>Action</code> matched based on the contents defined inside.</p></li><li><p><code>Resource</code> is the action that go against. In the above example, it is against dynamodb.
the Resource has to comply ARN. All ARNs are with following structure: <code>arn:partition:service:region:account_id:resource</code></p><p><img src=/images/arn.png alt=arn></p></li></ul><p>IAM policy joins all other applicable policies. There are AWS managed IAM policy that you could use, however you are always free to create your own IAM policy. It&rsquo;s used to delegate administration to other users to prevent privilege escalation or unnecessarily broad permissions. You can control the maximum permissions IAM policy can grant.</p><p>use cases including</p><ul><li>developer create roles for lambda function</li><li>application owner creates roles for EC2 instances</li><li>admin create ad hoc users.</li></ul><h3 id=resource-access-manager>Resource Access Manager
<a class=heading-link href=#resource-access-manager><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>RAM allows resource sharing between accounts. Not all the services can be shared.</p><h3 id=single-sign-on-sso>Single Sign On (SSO)
<a class=heading-link href=#single-sign-on-sso><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>SSO helps <strong>centrally</strong> managing access to AWS accounts and business applications.</p><h3 id=iam-miscellaneous>IAM miscellaneous
<a class=heading-link href=#iam-miscellaneous><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>power user access allows access to all AWS services except the management of groups and users within IAM</li><li>a policy is a document that provides a formal statement of one or more permissions</li></ul><h2 id=how-to-be-alarmed>How to be alarmed
<a class=heading-link href=#how-to-be-alarmed><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p><code>CloudWatch</code> and create an alarm</p><h2 id=s3>S3
<a class=heading-link href=#s3><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><h3 id=general-overview>general overview
<a class=heading-link href=#general-overview><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>S3 is <strong>Object-based</strong> storage, <strong>cannot hold db or os on top it</strong>.</li><li>files can be from 0 Bytes to 5TB</li><li>unlimited storage</li><li>files are stored in <code>Buckets</code></li><li>S3 is a universal namespace, names must be unique <strong>globally</strong></li><li>control access to buckets using either a bucket ACL or using Bucket Policies</li><li>successful uploads will generate <strong>HTTP 200</strong> status code</li><li>you can turn on MFA to prevent accidental deleting</li></ul><h3 id=fundamentals>fundamentals
<a class=heading-link href=#fundamentals><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li><code>Key</code> is simply the name of the object</li><li><code>Value</code> is simply the data and is made up of a sequence of bytes</li><li><code>Version ID</code> is important to distinguish versions</li><li><code>Metadata</code></li><li><code>Subresources</code> includes <strong>Access Control Lists</strong> and <strong>Torrent</strong></li><li>S3 has <strong>Read after Write consistency for PUTS of new objects</strong></li><li><strong>Eventual consistency for overwrite PUTS and DELETES (might need time to propagate)</strong></li></ul><p>here is a table to compare</p><table><thead><tr><th style=text-align:center></th><th style=text-align:center>S3 Standard</th><th style=text-align:center>S3 Intelligent-Tiering*</th><th style=text-align:center>S3 Standard-IA</th><th style=text-align:center>S3 One Zone-IA†</th><th style=text-align:center>S3 Glacier</th><th style=text-align:center>S3 Glacier Deep Archive</th></tr></thead><tbody><tr><td style=text-align:center>Designed for durability</td><td style=text-align:center>99.999999999% (11 9’s)</td><td style=text-align:center>99.999999999% (11 9’s)</td><td style=text-align:center>99.999999999% (11 9’s)</td><td style=text-align:center>99.999999999% (11 9’s)</td><td style=text-align:center>99.999999999% (11 9’s)</td><td style=text-align:center>99.999999999% (11 9’s)</td></tr><tr><td style=text-align:center>Designed for availability</td><td style=text-align:center>99.99%</td><td style=text-align:center>99.9%</td><td style=text-align:center>99.9%</td><td style=text-align:center>99.5%</td><td style=text-align:center>99.99%</td><td style=text-align:center>99.99%</td></tr><tr><td style=text-align:center>Availability SLA</td><td style=text-align:center>99.9%</td><td style=text-align:center>99%</td><td style=text-align:center>99%</td><td style=text-align:center>99%</td><td style=text-align:center>99.9%</td><td style=text-align:center>99.9%</td></tr><tr><td style=text-align:center>Availability Zones</td><td style=text-align:center>≥3</td><td style=text-align:center>≥3</td><td style=text-align:center>≥3</td><td style=text-align:center>1</td><td style=text-align:center>≥3</td><td style=text-align:center>≥3</td></tr><tr><td style=text-align:center>Minimum capacity charge per object</td><td style=text-align:center>N/A</td><td style=text-align:center>N/A</td><td style=text-align:center>128KB</td><td style=text-align:center>128KB</td><td style=text-align:center>40KB</td><td style=text-align:center>40KB</td></tr><tr><td style=text-align:center>Minimum storage duration charge</td><td style=text-align:center>N/A</td><td style=text-align:center>30 days</td><td style=text-align:center>30 days</td><td style=text-align:center>30 days</td><td style=text-align:center>90 days</td><td style=text-align:center>180 days</td></tr><tr><td style=text-align:center>Retrieval fee</td><td style=text-align:center>N/A</td><td style=text-align:center>N/A</td><td style=text-align:center>per GB retrieved</td><td style=text-align:center>per GB retrieved</td><td style=text-align:center>per GB retrieved</td><td style=text-align:center>per GB retrieved</td></tr><tr><td style=text-align:center>First byte latency</td><td style=text-align:center>milliseconds</td><td style=text-align:center>milliseconds</td><td style=text-align:center>milliseconds</td><td style=text-align:center>milliseconds</td><td style=text-align:center>select minutes or hours</td><td style=text-align:center>select hours</td></tr><tr><td style=text-align:center>Storage type</td><td style=text-align:center>Object</td><td style=text-align:center>Object</td><td style=text-align:center>Object</td><td style=text-align:center>Object</td><td style=text-align:center>Object</td><td style=text-align:center>Object</td></tr><tr><td style=text-align:center>Lifecycle transitions</td><td style=text-align:center>Yes</td><td style=text-align:center>Yes</td><td style=text-align:center>Yes</td><td style=text-align:center>Yes</td><td style=text-align:center>Yes</td><td style=text-align:center>Yes</td></tr></tbody></table><p>always refer to <a href="https://aws.amazon.com/s3/faqs/?nc=sn&amp;loc=7" class=external-link target=_blank rel=noopener>AWS FAQ</a></p><h3 id=encryption>encryption
<a class=heading-link href=#encryption><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>encrpytion in transit is achieved by SSL/TLS</p><ul><li>server side encryption<ul><li>S3 Managed keys - SSE - S3</li><li>From AWS Key Management Service called Managed Keys - SSE - KMS</li><li>Customer Provided Keys - SSE - C</li></ul></li><li>client side encryption</li></ul><h3 id=versioning>versioning
<a class=heading-link href=#versioning><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>versioning stores all versions of an object (including delete, it will be a delete marker)</li><li>it&rsquo;s a great backup tool</li><li>once enabled, versioning cannot be disabled, only suspended</li><li>it can be integrated with lifecycle rules</li><li>versioning&rsquo;s MFA delete capability can be used to provide additional layer of security</li></ul><h3 id=life-cycle-rules>life cycle rules
<a class=heading-link href=#life-cycle-rules><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>can find life cycle rules under management</p><p>it</p><ul><li>automates moving your objects between the different storage tiers</li><li>can be used in conjuction with versioning, can be applied to current version or previos version</li></ul><h3 id=s3-object-lock-and-s3-glaciers-vault-lock>S3 Object Lock and S3 Glaciers Vault Lock
<a class=heading-link href=#s3-object-lock-and-s3-glaciers-vault-lock><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li><p>S3 Object Lock
S3 Object Lock you can use <strong>Write Once Read Many</strong> policy (WORM policy).</p><p>There are two modes that you could choose. <strong>Governance Mode</strong> or <strong>Compliance Mode</strong>.</p><ul><li>Governance mode user cannot overwrite or delete object version or alter its lock settings unless he has <strong>special permission</strong>.</li></ul><p>whereas</p><ul><li>Compliance mode user cannot delete or overwrite protected objects even he is a root user. Its retention mode cannot be changed and retention period cannot be shortened.</li></ul></li><li><p>Retention
Retention is a period of time protects an object for a fixed amount of time. After the retention expired, the object version can be overwritten or deleted unless you also place a <strong>legal hold</strong> on the object version.</p></li><li><p>Legal Hold
A legal hold is like a retention period that prevent people overwrite or delete on an object version. Unlike retention period, people can freely place legal hold if he has <code>s3:PutObjectLegalHold</code> permission.</p></li><li><p>S3 Glacier Vault Lock
It allows you easily deploy and enforce Compliance control for individual glacier vault with a vault lock policy. You can specify controls such as WORM and lock policy from future edits. Once locked, the policy can no longer be changed.</p></li></ul><h3 id=s3-performance>S3 Performance
<a class=heading-link href=#s3-performance><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li><p>S3 Prefix</p><p>the strings between bucket name and object name. for example: <code>mybucketname/myfolder/subfolder1/object.jpg</code> prefix is <code>/myfoldre/subfolder1/</code></p></li><li><p>Number of Requests</p><p>Currently AWS can do 5500 GET/HEAD and 3500 PUT/COPY/POST/DELETE per second per <strong>prefix</strong>. So if you want to increase speed of reads, you can spread to different prefixes. for example, if we have 2 prefix, we could achieve 11000 reads per second.</p></li><li><p>KMS Limits</p><p>If you are using SSE-KMS to encrypt your object, uploading and downloading will count towards the <strong>quota</strong>.
It&rsquo;s either 5500/10000/30000 depends on regions.
Currently you cannot increase the quota.</p></li><li><p>Multi upload and byte range fetches</p><p>Use multi uploads to upload file over 100mb and <strong>must</strong> use it when file&rsquo;s over 5GB.
User byte range fetches to increase performance when downloading files to S3.</p></li></ul><h3 id=s3-select--glacier-select>S3 Select & Glacier Select
<a class=heading-link href=#s3-select--glacier-select><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>S3 Select is used to retrieve only a subset of data using SQL query, it saves money on data speed and cost.
Glacier Select is a similar stuff.</p><h3 id=datasync>DataSync
<a class=heading-link href=#datasync><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>DataSync is used to transfer large amount of data from on-promise data center to AWS. DataSync can be used with NFS- and SMB- compatible file system. Replication can be done hourly, daily or weekly.</p><p>After installing DataSync Agent in on-promise data center, it can start replication. It can be used to replicate from EFS to EFS.</p><h3 id=s3-miscellaneous>S3 miscellaneous
<a class=heading-link href=#s3-miscellaneous><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>Until 2018 there was a hard limit on S3 puts of 100 PUTs per second. To achieve this care needed to be taken with the structure of the name Key to ensure parallel processing. As of July 2018 the limit was raised to 3500 and the need for the Key design was basically eliminated. Disk IOPS is not the issue with the problem. The account limit is not the issue with the problem.</li><li>OneZone-IA is only stored in one Zone. While it has the same Durability, it may be less Available than normal S3 or S3-IA.</li><li>S3 has multipart upload API to deal with large file uploading</li><li>Virtual style puts your bucket name 1st, s3 2nd, and the region 3rd. Path style puts s3 1st and your bucket as a sub domain. Legacy Global endpoint has no region. S3 static hosting can be your own domain or your bucket name 1st, s3-website 2nd, followed by the region. AWS are in the process of phasing out Path style, and support for Legacy Global Endpoint format is limited and discouraged. However it is still useful to be able to recognize them should they show up in logs. <a href=https://docs.aws.amazon.com/AmazonS3/latest/dev/VirtualHosting.html class=external-link target=_blank rel=noopener>https://docs.aws.amazon.com/AmazonS3/latest/dev/VirtualHosting.html</a></li><li>100 buckets per account by default</li></ul><h2 id=aws-organizations>aws organizations
<a class=heading-link href=#aws-organizations><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>we can enable/disable aws services using Service Control Policies (SCP) either on OU or on individual accounts</p><p>want to perform as another role? three ways sharing S3 buckets across accounts</p><p>how to grant <a href=https://aws.amazon.com/premiumsupport/knowledge-center/cross-account-access-s3/ class=external-link target=_blank rel=noopener>cross acccount access</a></p><ul><li>[programmatic access only] using bucket policies & IAM (applies across the <strong>entire bucket</strong>)</li><li>[programmatic access only] using bucket ACLs & IAM (<strong>individual objects</strong>)</li><li>cross account IAM roles. this is both console access and programmatic access</li></ul><h2 id=cross-region-replication>cross region replication
<a class=heading-link href=#cross-region-replication><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>versioning must be enabled on both the source and destination buckets</li><li>files in an existing bucket are not replicated automatically</li><li>delete markers are not replicated, deleting individual versions or delete markers will not be deleted</li></ul><h2 id=cloudfront>CloudFront
<a class=heading-link href=#cloudfront><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>key terms</p><ul><li>edge location: where the content will be cached</li><li>origin: origin of all the files that CDN will distribute (can be <strong>S3, EC2, Elastic load balancer or route53</strong>)</li><li>distribution: basically it&rsquo;s a collection of edge locations. 1. web distribution 2. RTMP used for media streaming</li></ul><p>note that</p><ol><li>edge location can not only read but also write(transfer acceleration)</li><li>objects are cached for the life fo the <strong>TTL</strong></li><li>cache can be clear, but amazon will charge</li></ol><h3 id=cloudfront-signed-url-or-signed-cookies>CloudFront Signed URL or signed cookies
<a class=heading-link href=#cloudfront-signed-url-or-signed-cookies><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>CloudFront signed URL and signed cookie can be used under user cases like premium streaming stuff.</p><p>typically if you allow client to view <strong>one</strong> file, then use a signed URL; if you want him to view multiple files, then use signed cookies.</p><p>When we created a signed URL or signed cookie, we attach policies including URL expiration, IP ranges and trust signers.</p><p>From CloudFront to S3, use Origin Access Identity (OAI) to do a restricted access.</p><h2 id=snowball>snowball
<a class=heading-link href=#snowball><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>snowball is the service amazon import/export large amount data to S3</p><p>once I heard amazon compares how sufficient transfer large amount data thru transportation over HTTP</p><h2 id=storage-gateway>storage gateway
<a class=heading-link href=#storage-gateway><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>file gateway: for files, stored directly on S3</li><li>stored volumes: entire dataset is stored on site and is asynchronously backed up to S3</li><li>cache volumes: entire dataset is stored on S3 and most frequently accessed data is cached on site</li><li>gateway virtual tape library</li></ul><h2 id=athena>athena
<a class=heading-link href=#athena><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>athena is an interactive query service</li><li>it allows you to query data located in S3 using standard SQL</li><li>serverless</li><li>commonly used to analyse log data stored in S3</li></ul><h2 id=macie>macie
<a class=heading-link href=#macie><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>macie uses AI to analyze data in S3 and helps identify PII (personal identifiable information)</li><li>can also be used to analyse <code>CloudTrail</code> logs for suspicious API activity</li><li>includes dashboards, reports and alerting</li><li>great for PCI-DSS compliance and preventing ID theft</li></ul><h2 id=ec2>EC2
<a class=heading-link href=#ec2><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>elastic compute cloud</p><p>pricing type: on demand, reserved, spot and dedicated hosts</p><p>if the spot instance is terminated by EC2, you will not be charged partial hour of usage; however if you terminate the instance youself, you will be charged for any hour.</p><ul><li>termination protection is turned off by default</li><li>default action is for the root EBS volume to be deleted when the instance is terminated</li><li>EBS root volumes can be encrypted</li><li>additional volumes can be encrypted</li></ul><h3 id=spot-instances-and-spot-fleet>spot instances and spot fleet
<a class=heading-link href=#spot-instances-and-spot-fleet><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>spot instances can be used in stateless, fault-tolerant or flexible application scenarios, such as big data, containerized workload, CI/CD, high performance computing.</p><p>spot instances can request one time or persistent. When required persistent, it will start the instance and stop once its price go over your bid; and resume once its price go below your bid.</p><p>spot fleet is a collection of spot instances and, optionally, on-demand instances.</p><p>For spot fleet you can have <code>capacityOptimized</code>, <code>lowestPrice</code>, <code>diversified</code> and <code>instancePoolToUseCount</code>. <code>lowestPrice</code> strategy is the default one, the instances comes from the pool with lowest price; <code>capacityOptimized</code> will try to keep the capacity you set.</p><h3 id=ec2-hibernate>EC2 hibernate
<a class=heading-link href=#ec2-hibernate><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>EC2 hibernate will save your RAM to EBS and stop the instance. And once restart it will resume the RAM and the RAM is so preserved. It&rsquo;s much faster to boost up because you don&rsquo;t need to reload your operating system. RAM has to be less than 150GB, won&rsquo;t be hibernated for 60 days. Available for on-demand and reserved instances.</p><h2 id=security-group>security group
<a class=heading-link href=#security-group><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>all inbound traffic is blocked by default</li><li>all outbound traffic is allowed</li><li>changes to security groups take effect immediately</li><li>can have multiple EC2 instances attached to multiple security groups</li><li>security groups are <a href=https://stackoverflow.com/questions/53622935/what-is-meant-by-security-groups-are-stateful class=external-link target=_blank rel=noopener>stateful</a> (if creating an inbound rule allowing traffic in, that traffic is allowed back)</li><li>cannot block specific IP addresses using security groups, instead using network access control list</li><li>can specify allow rules, but not deny rules</li></ul><h3 id=elastic-block-store-ebs>Elastic Block Store (EBS)
<a class=heading-link href=#elastic-block-store-ebs><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><table><thead><tr><th></th><th>Solid State Drives (SSD)</th><th></th><th>Hard Disk Drives (HDD)</th><th></th></tr></thead><tbody><tr><td>Volume Type</td><td>EBS Provisioned IOPS SSD (io1)</td><td>EBS General Purpose SSD (gp2)*</td><td>Throughput Optimized HDD (st1)</td><td>Cold HDD (sc1)</td></tr><tr><td>Short Description</td><td>Highest performance SSD volume designed for latency-sensitive transactional workloads</td><td>General Purpose SSD volume that balances price performance for a wide variety of transactional workloads</td><td>Low cost HDD volume designed for frequently accessed, throughput intensive workloads</td><td>Lowest cost HDD volume designed for less frequently accessed workloads</td></tr><tr><td>Use Cases</td><td>I/O-intensive NoSQL and relational databases</td><td>Boot volumes, low-latency interactive apps, dev & test</td><td>Big data, data warehouses, log processing</td><td>Colder data requiring fewer scans per day</td></tr><tr><td>API Name</td><td>io1</td><td>gp2</td><td>st1</td><td>sc1</td></tr><tr><td>Volume Size</td><td>4 GB - 16 TB</td><td>1 GB - 16 TB</td><td>500 GB - 16 TB</td><td>500 GB - 16 TB</td></tr><tr><td>Max IOPS**/Volume</td><td>64,000</td><td>16,000</td><td>500</td><td>250</td></tr><tr><td>Max Throughput***/Volume</td><td>1,000 MB/s</td><td>250 MB/s</td><td>500 MB/s</td><td>250 MB/s</td></tr><tr><td>Max IOPS/Instance</td><td>80,000</td><td>80,000</td><td>80,000</td><td>80,000</td></tr><tr><td>Max Throughput/Instance</td><td>2,375 MB/s</td><td>2,375 MB/s</td><td>2,375 MB/s</td><td>2,375 MB/s</td></tr><tr><td>Price</td><td>$0.125/GB-month$0.065/provisioned IOPS</td><td>$0.10/GB-month</td><td>$0.045/GB-month</td><td>$0.025/GB-month</td></tr><tr><td>Dominant Performance Attribute</td><td>IOPS</td><td>IOPS</td><td>MB/s</td><td>MB/s</td></tr></tbody></table><p>click <a href=https://aws.amazon.com/ebs/features/ class=external-link target=_blank rel=noopener>here</a> for more</p><h3 id=volumes-snapshots-and-ami>volumes, snapshots and AMI
<a class=heading-link href=#volumes-snapshots-and-ami><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>volumes exist on EBS. EBS &ndash;> virtual hard disk</li><li>snapshots exist on S3. snapshots &ndash;> a photograph of the disk</li><li>snapshots are point in time copies of volumes.</li><li>snapshots are incremental &ndash; this means that only the blocks that have changed since your last snapshot are moved to S3</li><li>taking snapshot can be done at both when instance is running or stopped. However, it&rsquo;s best practice to take snapshot when the instance is stopped.</li><li>you can create AMI from snapshots</li><li>you can change EBS volume type and size on the fly</li><li>volumes will always be in the same availability zone as the EC2 instance.</li></ul><p>tricks to move EC2 from one availability zone to another</p><p>take snapshot of the EC2 &ndash;> create AMI from the snapshot &ndash;> use the AMI to launch the EC2 instance in a new availability zone.</p><p>tricks to move EC2 from one region to another</p><p>take snapshot of the EC2 &ndash;> create AMI from the snapshot &ndash;> copy the AMI from on region to another &ndash;> use the copied AMI to launch the new EC2 instance in the new region.</p><h3 id=instance-storage-vs-ebs>instance storage vs EBS
<a class=heading-link href=#instance-storage-vs-ebs><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>instance storage is also called ephemeral storage</p><ul><li>instance storage cannot be stopped. if the host fails, you will lose data</li><li>EBS backed instances can be stopped.</li><li>you can reboot both, you will not lose your data</li><li>both root volumes will be deleted on termination by default. with EBS volume, you could tell AWS to keep the root device volume</li><li>EBS replicated data within the same AZ by default; S3 replicate data to multi AZs by default.</li></ul><h3 id=eni-vs-en-vs-efa>ENI vs EN vs EFA
<a class=heading-link href=#eni-vs-en-vs-efa><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li><p>Elastic Network Interface (ENI)</p><p>it&rsquo;s essentially a virtual network card. it would be used for basic networking. scenarios including needs of a seperate management network to your production network or a seperate logging network and doing in a low cost.</p></li><li><p>Enhanced Network</p><p>used for enhancing network throughput (reliable and high throughput), a user case scenario would be HPC networking requirements.</p></li><li><p>Enhanced Network Adapter</p><p>It supports up to 100Gbps for supported instances.</p></li><li><p>Elastic Fabric Adaptor</p><p>EFA is used when needs to accelerate high performance computing (HPC) and machine learning applications or need to do an OS by-pass.</p></li></ul><h3 id=encryption-and-snapshots>encryption and snapshots
<a class=heading-link href=#encryption-and-snapshots><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>you can only share unencrypted snapshots</li><li>snapshots can be shared with other AWS account or make it public</li></ul><h3 id=good-old-days-when-you-cannot-encrypted-root-device-when-creating-it>good old days when you cannot encrypted root device when creating it
<a class=heading-link href=#good-old-days-when-you-cannot-encrypted-root-device-when-creating-it><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>how to encrypt the root device then</p><ul><li>create a snapshot of the unencrypted root device volume</li><li>create a copy of the snapshot and select the encrypt option</li><li>create an AMI from the encrypted snapshot</li><li>use the AMI to launch new encrypted instances</li></ul><h3 id=cloudwatch-vs-cloudtrail>CloudWatch vs CloudTrail
<a class=heading-link href=#cloudwatch-vs-cloudtrail><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>CloudWatch is used for monitoring performance however CloudTrail is use for auditing (API calls to AWS, user management)</li><li>CloudWatch can monitor most of AWS as well as your applications that run on AWS</li></ul><h3 id=elastic-file-system-efs>Elastic File System (EFS)
<a class=heading-link href=#elastic-file-system-efs><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>EFS can be share among several EC2 instances</p><ul><li>supports NFSv4 protocal</li><li>only pay for the storage you use</li><li>can scale up to petabytes</li><li>support thousands of concurrent NFS connections</li><li>data is stored across multiple AZ&rsquo;s within a region</li><li>read after write consistency</li></ul><h3 id=efs-vs-fsx-for-windows-vs-fsx-for-lustre>EFS vs FSX for Windows vs FSX for Lustre
<a class=heading-link href=#efs-vs-fsx-for-windows-vs-fsx-for-lustre><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>EFS: when need distributed, highly resilient storage for linux instances and linux based applications</li><li>FSX for Windows: when need centralized storage for Windows-based applications such as SQL server or any other native MS application</li><li>FSX for Lustre: when need high-speed, high capacity distributed storage. this will be for HPC, financial modeling, etc. FSX for Lustre can store data directly on S3.</li></ul><h3 id=ec2-placement-groups>EC2 placement groups
<a class=heading-link href=#ec2-placement-groups><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>there are three kinds of groups</p><ul><li><p>clustered placement group</p><p>clustered placement group are recommended for applications need low network latency and high throughput</p></li><li><p>spread placement group</p><p>spread placement groups are for applications that have a small number of critical instances that should be kept from each other</p><p>Amazon commits that instances within spread placement groups will be on different racks</p></li><li><p>partitioned</p><p>Amazon divides each group into logical segments. EC2 ensures that each partition within a placement group has its own rack, each rack has its own network and power source. allow you to isolate the impact of hardware failure within your application.</p></li></ul><p>for multiple EC2 instances could be HDFS, HBase and Casssandra.</p><ul><li>a clustered placement group cannot span multiple availibility zones, however spread placement and partitioned group can.</li><li>name you specify for a placement group must be unique within your AWS account.</li><li>cannot merge placement groups.</li><li>you can move an existing instance into placement group. but before move, the instance must be stopped and you can only move via CLI and SDK.</li></ul><h3 id=aws-and-hpc>AWS and HPC
<a class=heading-link href=#aws-and-hpc><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>We can achieve HPC on AWS by</p><ol><li><p>data transfer</p></li><li><p>compute and networking</p></li><li><p>storage</p></li><li><p>orchestration and automation</p></li><li><p>data transfer</p></li></ol><p>By using Snowball, SnowMobile which will transfer terabytes and perabytes of data. Or using DataSync sync data to store on S3, EFS, FSx for Windows, etc. Or Direct Connect.</p><ol start=2><li>compute and networking</li></ol><p>Options are EC2 instances be GPU and CPU optimized, EC2 fleets (spot instances and spot fleets), placement groups specifically cluster placement groups, Enhanced networking single I/O Virtualization (SR-IOV), Enhanced Network Adapter and Enhanced Fabric Adapter.</p><ol start=3><li>storage</li></ol><p>Instance-attached storage including EBS 64000 IOPS or provisioned IOPS or Instance Store which has low latency.
Network storage including S3, EFS and FSx for Lustre</p><ol start=4><li>orchestration and automation</li></ol><p>AWS Batch and AWS ParallelCluster</p><h3 id=web-application-firewall-waf>Web Application Firewall (WAF)
<a class=heading-link href=#web-application-firewall-waf><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>layer 7 application</p><p>when asked to block malicious IP addresses, malicious script, blocking requests certain country originated from</p><p>you can use either <strong>WAF</strong> or <strong>network ACLs</strong> (will be discussed in VPC)</p><p>when you are asked to block an IP, use <strong>NACL</strong>.</p><h3 id=ec2-miscellenous>EC2 miscellenous
<a class=heading-link href=#ec2-miscellenous><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>use <code>curl http://169.254.169.254/latest/meta-data/</code> to see various meta data for this EC2</li><li>I cannot move a reserved instance form one region to another, however depending on type of RI I can modify AZ, scope, network platform, instance size etc.</li><li>EBS, EFS and FSx are all block-based storage</li><li>If EBS is additional partition, I can detach it without stopping the instance</li><li>I can change a role even if it was assigned and will take effect immediately</li><li>you can attach Provisioned IOPS (io1) EBS volumes to multiple EC2 instances (new as Feb 2020)</li></ul><h2 id=databases-in-aws>Databases in AWS
<a class=heading-link href=#databases-in-aws><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>6 relational DB on AWS are <code>SQL Server</code>, <code>Oracle</code>, <code>MySQL</code>, <code>PostgreSQL</code>, <code>Aurora</code> and <code>MariaDB</code></p><p>relational DBs has two features on AWS:</p><ol><li>multi AZ - for disaster recovery</li><li>read replicas - for performance</li></ol><p>read replicas will have to setup connections by user manually.</p><p>DynamoDb is Amazon&rsquo;s no sql solution</p><p>OLTP vs OLAP</p><p>OLAP requires data warehouse solution, Amazon&rsquo;s data warehouse solution is called Redshift</p><p>Redshift is used for business intelligence</p><h2 id=relational-db-on-aws>relational DB on AWS
<a class=heading-link href=#relational-db-on-aws><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>RDS runs on virtual machines, however you as a user cannot access to that virtual machine. Patching of the RDS OS and DB is Amazon&rsquo;s responsibility.</li><li>RDS is NOT serverless</li><li>Aurora serverless is serverless</li></ul><h2 id=backups-multiaz-and-read-replicas>backups, multiAZ and read replicas
<a class=heading-link href=#backups-multiaz-and-read-replicas><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ol><li>backups
two different types of backups<ul><li>automated backups</li><li>database snapshots</li></ul></li></ol><p>DB snapshots are done manually and they are stored even after you delete the original RDS instance.</p><p>Business always define Recovery Point Objective and Recovery Time Objective, usually RPO is in minutes and RTO is in hours.</p><p>RPO refers to maximum period of data loss that is acceptable in the event of a failure or incident.
RTO refers to maximum amount of downtime that is permitted to recover from backup and to resume processing</p><ol start=2><li>multiAZ</li></ol><p>multiAZ allows you to have copy of your production db, amazon handles the replication for you so it will auto failover to standby db when needed.</p><p>multiAZ is used for disaster recovery.</p><p>you can force a failover from one AZ to another by rebooting the RDS instance.</p><ol start=3><li>read replicas</li></ol><p>read replicas is used for performance improvements.</p><pre><code>* used for scaling
* must have automatic backups turned on in order to deploy a read replica.
* you can have up to 5 read replicas of any db.
* you can have read replicas of read replicas( watch the latency)
* each read replica will have its own DNS endpoint.
* you can have read replicas that have multiAZ
* you can create read replicas of multiAZ source db
* read replicas can be promoted to their own db, but it will break the replication
* can have a read replica in a second region
</code></pre><h3 id=dynamodb>dynamoDB
<a class=heading-link href=#dynamodb><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>amazon&rsquo;s no sql service</p><ul><li>stored on SSD so that it&rsquo;s quick</li><li>spread across 3 distinct data center</li><li>eventual consistent reads (default)</li><li>strongly consistent reads</li></ul><h3 id=redshift>redshift
<a class=heading-link href=#redshift><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>backups for redshift</p><ul><li>only available in 1 AZ</li><li>enable by default with 1 day retention period up to 35 days</li><li>it always attempts to maintain at least 3 copies of your data (the original and replica on the compute nodes and a backup in Amazon S3)</li><li>redshift can also asynchronously replicate your snapshots to S3 in another region for disaster recovery</li></ul><p>Amazon Redshift organizes the data by column instead of storing data as a series of rows. Because only the columns involved in the queries are processed and columnar data is stored sequentially on the storage media, column-based systems require far fewer I/Os, which greatly improves query performance.</p><h3 id=aurora>aurora
<a class=heading-link href=#aurora><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>2 copies of your data are contained in each AZ with minimum of 3 AZ. in total 6 copies in min</li><li>it will handle the loss of up to 2 copies of data w/o affecting write, 3 copies of data w/o affecting read</li><li>can share aurora snapshots with other AWS accounts</li><li>only 3 types of replicas available in aurora, they are aurora replicas (up to 15), MySQL replicas (up to 5) and PostgresQL replicas (up to 1), only aurora replica does failovers</li><li>use aurora serverless if you want a simple, cost-effective option for infrequent, intermittent or unpredictable workloads.</li></ul><h3 id=elasticache>Elasticache
<a class=heading-link href=#elasticache><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>in-memory cache in the cloud</p><ul><li>memcached</li><li>redis</li></ul><p>redis can be multi AZ
redis can do backup and restore</p><h3 id=database-migration-service-dms>Database Migration Service (DMS)
<a class=heading-link href=#database-migration-service-dms><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>As the name indicated, DMS will migrate data from one database to another, what interesting is AWS DMS will do on-promises to on-promises, on-promises to cloud, cloud to on-promises or cloud to cloud. It can as do homogeneous migration or heterogeneous migration.</p><p>However when doing a heterogeneous migration it will need a schema-convertion-tool.</p><p>for example, data from Oracle to Aurora, you will need schema conversion sometimes.</p><h3 id=cache-strategy>Cache Strategy
<a class=heading-link href=#cache-strategy><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Caching is the balance act between up-to-date, accuracy and latency. The following services can cache</p><ul><li>CloudFront</li><li>API Gateway</li><li>ElasticCache</li><li>DynamoDB Accelerator (DAX)</li></ul><p>The lower the services the more latency it gets.</p><h3 id=elastic-map-reduce>Elastic Map Reduce
<a class=heading-link href=#elastic-map-reduce><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Amazon EMR is industry leading cloud big data platform process data using open source tools such as apache series.</p><p>Central component of Amazon EMR is the cluster. A cluster is a collection of EC2 instances. Each instance in the cluster called a node. Each node has a role within the cluster as node type.</p><p>Node types can be master node, core node, task node.</p><p>The master node tracks the status of the tasks and monitor the health of the cluster.</p><p>The core node runs the task and store the data.</p><p>The task node only runs tasks, doesn&rsquo;t store data in HDFS.</p><p>Only when created the cluster, you can configure master node archive the log files to S3, you cannot change it after you created the cluster.</p><h2 id=iam-advanced>IAM Advanced
<a class=heading-link href=#iam-advanced><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><h3 id=what-is-active-directory-ad>What is Active Directory (AD)
<a class=heading-link href=#what-is-active-directory-ad><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>AD comes from Windows. It&rsquo;s on-promises directory service with hierarchical database of users, groups computers with tree and forest structure. There are group policies.
It uses LDAP and DNS protocol.
It uses Kerberos, LDAP and NTLM as authentication.
It can be highly available.</p><h3 id=what-is-aws-active-directory-service-for-microsoft-active-directory>What is AWS Active Directory Service for Microsoft active directory
<a class=heading-link href=#what-is-aws-active-directory-service-for-microsoft-active-directory><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>It&rsquo;s a managed active directory service hosted on cloud. It&rsquo;s best to be used when 5000 and more people using AD Trust between AWS and on-promises AD.</p><p>AWS managed AD has AD domain controllers. DCs also managed by AWS (they are windows servers).</p><p>AWS managed AD is reachable by your applications in your VPC, with DCs adding, it&rsquo;s HA and of high performance.</p><h3 id=simple-ad>Simple AD
<a class=heading-link href=#simple-ad><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>As the name indicated, it&rsquo;s simpler than AWS manged AD.</p><p>It&rsquo;s a standalone managed directory with basic AD features. Small is less than 500 people and large is less than 5000 people. It&rsquo;s easier to manage EC2s. Linux workloads need LDAP.</p><p>Because it&rsquo;s supporting basic features, so it&rsquo;s not supporting AD Trust, so you cannot join on-promises AD to Simple AD.</p><h3 id=ad-connector>AD connector
<a class=heading-link href=#ad-connector><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>AD connector is like a proxy (Directory Gateway) for on-promises AD. It allows on-promises users to login to AWS so that it avoid cacheing information on cloud.</p><p>You can join EC2s to your existing AD domain, and scale across multiple AD connectors.</p><h3 id=cloud-directory>Cloud Directory
<a class=heading-link href=#cloud-directory><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Cloud Directory is a directory-store based store for developers. It contains hierarchies with hundreds of millions of objects. It&rsquo;s an AWS fully managed service, you can find org charts, registar, etc.</p><h3 id=amazon-cognito-user-pools>Amazon cognito user pools
<a class=heading-link href=#amazon-cognito-user-pools><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>It&rsquo;s a managed user directory for Saas applications. It&rsquo;s been used for sign-up and sign-in to web and mobile. Worked with social media identities.</p><h3 id=exam-tips>Exam tips
<a class=heading-link href=#exam-tips><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>AD compatible services: AWS managed AD, Simple AD and AD Connector</li><li>AD incompatible services: Cloud Directory, AWS Cognito User Pool.</li></ul><h2 id=route53>Route53
<a class=heading-link href=#route53><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><h3 id=dns-101>DNS 101
<a class=heading-link href=#dns-101><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p><a href=https://www.cloudflare.com/learning/dns/dns-records/ class=external-link target=_blank rel=noopener>cloudflare</a> links here.</p><ul><li><p>A record</p><p>The ‘A’ stands for ‘address’ and this is the most fundamental type of DNS record, it indicates the IP address of a given domain.</p><p>‘A’ records only hold Ipv4 addresses, if the site has a Ipv6 address, it will instead use an ‘AAAA’ record.</p><table><thead><tr><th style=text-align:center>example.com</th><th style=text-align:center>record type:</th><th style=text-align:center>value:</th><th style=text-align:center>TTL</th></tr></thead><tbody><tr><td style=text-align:center>@</td><td style=text-align:center>A</td><td style=text-align:center>12.34.56.78</td><td style=text-align:center>14400</td></tr></tbody></table></li><li><p>Name Server records</p><p>The NS record indicates which DNS server is authoritative.</p><p>Example of an NS record:</p><table><thead><tr><th style=text-align:center>example.com</th><th style=text-align:center>record type:</th><th style=text-align:center>value:</th><th style=text-align:center>TTL</th></tr></thead><tbody><tr><td style=text-align:center>@</td><td style=text-align:center>NS</td><td style=text-align:center>ns1.exampleserver.com</td><td style=text-align:center>21600</td></tr></tbody></table></li><li><p>Canonical Name record (CNAME record)</p><p>The ‘canonical name’ record is used in lieu of an A record, when a domain or subdomain is an alias of another domain.</p><p>All CNAME records must point to a domain, never to an IP address.</p><table><thead><tr><th style=text-align:center>blog.example.com</th><th style=text-align:center>record type:</th><th style=text-align:center>value:</th><th style=text-align:center>TTL</th></tr></thead><tbody><tr><td style=text-align:center>@</td><td style=text-align:center>CNAME</td><td style=text-align:center>is an alias of example.com</td><td style=text-align:center>32600</td></tr></tbody></table></li><li><p>Start Of Authority (SOA record)</p><p>The ‘start of authority’ record can store important info about the domain such as the email address of the administrator, when the domain was last updated, and how long the server should wait between refreshes.</p><table><thead><tr><th style=text-align:center>example.com</th><th style=text-align:center>record type:</th><th style=text-align:center>value:</th><th style=text-align:center>TTL</th></tr></thead><tbody><tr><td style=text-align:center>@</td><td style=text-align:center>SOA</td><td style=text-align:center>admin.example.com</td><td style=text-align:center>11200</td></tr></tbody></table></li><li><p>Pointer Record (PTR Record)</p><p>A pointer (PTR) record is a type of Domain Name System (DNS) record that resolves an IP address to a domain or host name.
PTR records are used for the reverse DNS lookup. Using the IP address, you can get the associated domain or host name.</p></li><li><p>Sender Policy Framework Record (SPF Record)</p><p>An SPF record is a Sender Policy Framework record. It&rsquo;s used to indicate to mail exchanges which hosts are authorized to send mail for a domain.</p></li></ul><h3 id=route53-specific>Route53 specific
<a class=heading-link href=#route53-specific><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li><p>ELBs don&rsquo;t have pre-defined ipv4 addresses, you resolve to them using a DNS name.</p></li><li><p>Alias records</p><p>Alias records are used ot map resource record sets in your hosted zone to Elastic Load Balancers, CloudFront distributions or S3 buckets that are configured as websites.</p><p>Alias records work like a CNAME record in that you can map one DNS name to another &rsquo;target&rsquo; DNS name.</p><p>the key difference between CNAME and Alias Record is that CNAME cannot be used for zone apex record (eg. you cannot have yourdomain.com as a CNAME)</p></li><li><p>CNAME hack in cloudflare</p><p>CloudFlare now supports CNAME Flattening, which is a better solution to this same problem. in other words, CloudFlare allows you to set your zone apex to a CNAME.</p><p>so basically you can do this now using cloudflare</p><p>yourdomain.com CNAME some-id.ec2.amazonaws.com</p></li></ul><h3 id=simple-routing-policy>Simple Routing Policy
<a class=heading-link href=#simple-routing-policy><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Using A Recored. if you have one record with multiple IP addresses, route 53 will return values in random order.</p><h3 id=weighted-routing-policy>Weighted Routing Policy
<a class=heading-link href=#weighted-routing-policy><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Using A Record. as name indicated it goes to different IP addresses using weigh that you set.</p><h3 id=latency-based-routing-policy>latency based routing policy
<a class=heading-link href=#latency-based-routing-policy><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Using A Record. latency routing will give user the lowest response time.</p><h3 id=failover-routing-policy>failover routing policy
<a class=heading-link href=#failover-routing-policy><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>active/passive pattern. once the health check is not passed, it will failover to passive IP address.</p><h3 id=geolocation-routing-policy>geolocation routing policy
<a class=heading-link href=#geolocation-routing-policy><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>send user based on user&rsquo;s location</p><h3 id=geoproximity-routing-policy>geoproximity routing policy
<a class=heading-link href=#geoproximity-routing-policy><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>to use geoproximity routing you must enable traffic flow</p><h3 id=multivalue-answers-routing-policy>multivalue answers routing policy
<a class=heading-link href=#multivalue-answers-routing-policy><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>similar to simple, but can associate health check to it.</p><h2 id=virtual-private-cloud-vpc>Virtual Private Cloud (VPC)
<a class=heading-link href=#virtual-private-cloud-vpc><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>think of VPC consists of IGW(or virtual private gateways), route tables, network Access Control Lists, Subnets, and security groups</p><p>1 subnet = 1 AZ
subnet cannot span availability zones</p><p>security groups are stateful whereas ACLs are stateless</p><p>and VPCs doesn&rsquo;t allow TRANSITIVE PEERING</p><h3 id=vpc-peering>VPC peering
<a class=heading-link href=#vpc-peering><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>allows to connect one VPC with another via a direct network route using private IP addresses</li><li>instances behaves as if they were on the same private network</li><li>can peer VPC with other AWS accounts as well as with other VPC in the same account</li><li>peering is in a star configuration: ie 1 central VPC peers with 4 others</li><li>peering can among regions</li></ul><h3 id=vpc-creation-have-to-remember>VPC creation (<strong>have to remember</strong>)
<a class=heading-link href=#vpc-creation-have-to-remember><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>when freshly created, vpc comes with a default route table, network access control list and a default security group</p><p><img src=/images/freshcreatedvpc.PNG alt="freshly created vpc"></p><p>it won&rsquo;t create any subnets nor will it create a default internet gateway</p><p>the next step would be create a internet gateway, and associate to the VPC just created. in order to let internet traffic flow in, have to configure the route table, ACL and security group stuff if necessary.</p><p>the next step would create subnets</p><p><img src=/images/vpcpublicprivatesubnets.PNG alt="public and private subnets"></p><p>and then create route tables, leave the default route table as is, and create another route table to deal with public subnets</p><p>after the creation, select the route table just created and associate public subnet with it</p><p>also don&rsquo;t forget to add routes into it</p><p>next step, create instances in each subnet</p><p>select subnet accordingly, will find <code>auto-assign public ip</code> being &ldquo;use subnet setting (enable)&rdquo; or disable depending on which subnet you are choosing.</p><p><img src=/images/aftercreateinstances.PNG alt="after created some instances"></p><p>now we want instance in public subnet talks to instance in private subnet, what we do is to create a security group</p><p>within configuring SG, use cidr to config the inbound rule and outbound rule. then public and private instance could talk to each other.</p><h3 id=vpc-charateristics>VPC charateristics
<a class=heading-link href=#vpc-charateristics><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>the same AZ name in one&rsquo;s account (ie us-east-1a) can be completely different AZ in another account</li><li>amazon reserve 5 IP addresses within your subnets</li><li>you can only have 1 Internet Gateway per VPC (amazon guarantees highly availibility of that gateway)</li><li>security group cannot span VPCs.</li></ul><h3 id=nat-instances-and-nat-gateways>NAT instances and NAT gateways
<a class=heading-link href=#nat-instances-and-nat-gateways><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>when create a NAT instance, must disable source/destination check on the instance</li><li>NAT instance must be in a public subnet</li><li>must modify route table of private subnet to the NAT instance in order for this to work</li><li>NAT instance is behind a security group</li></ul><p>whereas NAT gateway is</p><ul><li>redundant inside the AZ</li><li>not associate with the security group</li><li>automatically assigned with a public ip address</li><li>remember to update your route tables</li><li>no need to disable source/destination checks</li></ul><p>both NAT instance and NAT gateway needs to update route table
and
better create NAT gateways in each AZ to have a AZ-independent architecture</p><h3 id=network-acls-vs-security-groups>Network ACLs vs Security groups
<a class=heading-link href=#network-acls-vs-security-groups><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>The difference between Security Group and ACLs is that, Security Group act as a firewall for associated Amazon EC2 instances, controlling both inbound and outbound traffic at the instance level, while ACLs act as a firewall for associated subnets, controlling both inbound and outbound traffic at the subnet level.</p><ul><li>you can associate a network ACL with multiple subnets, however a subnet can be associated with only one network ACL at a time.</li><li>network ACLs contain a numbered list of rules that evaluated in order, lowest numbered rule will overwrite higher number rule, whereas security group will access all the rules before it actually execute it.</li><li>network ACLs are stateless; responses to allowed inbound traffic are subject to the rules for outbound traffic; in other word, you have to specify both inbound and outbound rules.</li></ul><h3 id=vpc-flow-logs>VPC flow logs
<a class=heading-link href=#vpc-flow-logs><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>you cannot enable flow logs for VPCs that are peered with your VPC unless that VPC is in your account</li><li>cannot tag flow logs</li><li>after you&rsquo;ve created a flow log, you cannot change its configuration; for example you cannot change its IAM role</li></ul><p>not all traffic are monitored</p><ul><li>traffic generated by instances when they contact the Amazon DNS server.</li><li>traffic generated by a Windows instance for Amazon Windows license activation</li><li>traffic to and from 169.254.169.254 for instance metadata</li><li>DHCP traffic</li><li>traffic to reserved ip address for the default VPC router.</li></ul><h3 id=bastions>Bastions
<a class=heading-link href=#bastions><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>what is a bastions
<img src=/images/bastions.PNG alt=bastions></p><p>To reduce exposure of servers within the VPC you will create and use a bastion host</p><p>cannot use NAT gateway as a bastion host</p><h3 id=direct-connect>Direct Connect
<a class=heading-link href=#direct-connect><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>it directly connects your data center to AWS as the name indicated. useful for high throughput and needs for stable and realiable secure connection.</p><p>Steps to set up direct connections</p><ol><li>create a virtual interface in the Direct Connect Console. This is a <strong>Public Virtual Interface</strong>.</li><li>go to VPC console and then to VPN connections, create a Customer Gateway.</li><li>create a virtual private gateway</li><li>attach the virtual private gateway to the desired VPC</li><li>select VPN connections and create new VPN connections and select the virtual private gateway and the customer gateway</li><li>once the VPN is available, setup the VPN on the customer gateway or firewall</li></ol><h3 id=global-accelerator>Global Accelerator
<a class=heading-link href=#global-accelerator><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>reference from <a href="https://aws.amazon.com/global-accelerator/?blogs-global-accelerator.sort-by=item.additionalFields.createdDate&amp;blogs-global-accelerator.sort-order=desc&amp;aws-global-accelerator-wn.sort-by=item.additionalFields.postDateTime&amp;aws-global-accelerator-wn.sort-order=desc" class=external-link target=_blank rel=noopener>amazon</a></p><p>global accelerator is to improve availability and performance of your application for local and global</p><p>some components in AWS global accelerators</p><ul><li>static ip addresses</li><li>accelerator itself</li><li>DNS name</li><li>network zone</li><li>listener</li><li>endpoints group</li><li>endpoint</li></ul><p>amazon provides 2 ip addresses. And Amazon assigns each accelerator a default DNS name that points to the static ip address.</p><p>And when you configure accelerator, by default global accelerator allocates 2 ipv4 addresses for it. (seems like each ipv4 address is in a network zone). A network zone services the static ip addresses for you accelerator from a unique ip subnet, it is an isolated unit with its own infrastructure like AZ.</p><p>a listener processes inbound connections from clients to global accelerator. support both TCP and UDP. each listener has one or more endpoint groups associated with it and traffic is forwared to endpoints in one of the groups.</p><p>endpoint groups include one or more endpoints in the region, there is a traffic dial option lets you easily do performance testing or blue/green deployment testing for new releases accross different AWS regions.</p><p>endpoint, however different from endpoint groups, can be network load balancers, application network load balancers, EC2 instances or Elastic ip addresses.</p><h3 id=vpc-endpoints>VPC endpoints
<a class=heading-link href=#vpc-endpoints><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>VPC endpoint enables you to privately connect your VPC to supported AWS services and VPC endpoint services powered by PrivateLink without requiring an internet gateway, NAT, VPN or Direct Connection. traffic doesn&rsquo;t leave amazon network.</p><p>There are two types of VPC endpoints: interface endpionts and gateway endpoints</p><p>gateway endpoints support: S3 and DynamoDB.</p><p>one scenario using VPC gateway endpoint would be replacing NAT instances or NAT gateways.</p><h3 id=vpc-miscellaneous>VPC Miscellaneous
<a class=heading-link href=#vpc-miscellaneous><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>are you permitted to do vulnerability scan without telling AWS? AWS just changed their policy about alerting, though there still are conditions.</li><li>By default, instances in new subnets in a custom VPC can communicate with each other across Availability Zones.</li><li>A Bastion host allows you to securely administer (via SSH or RDP) an EC2 instance located in a private subnet. Don&rsquo;t confuse Bastions and NATs, which allow outside traffic to reach an instance in a private subnet.</li><li>You would only allow 0.0.0.0/0 on port 80 or 443 to to connect to your public facing Web Servers, or preferably only to an ELB. Good security starts by limiting public access to only what the customer needs. Please see the AWS Security whitepaper for complete details.</li></ul><h2 id=high-availability-architecture>High Availability architecture
<a class=heading-link href=#high-availability-architecture><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><h3 id=load-balancers>Load Balancers
<a class=heading-link href=#load-balancers><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>there are 3 types of load balancers</p><ol><li>application load balancer</li></ol><p>This is dealing with http and https requests (dealing <strong>request</strong> level). layer 7 and application aware.</p><ol start=2><li>network load balancer</li></ol><p>This is dealing with tcp and udp (dealing <strong>connection</strong> level). layer 4. can handle millions rps</p><ol start=3><li>classic load balancer</li></ol><p>This is an old balancer, load balance at both request and connection level. But this load balancer doesn&rsquo;t have a single connection with new application load balancer and network load balancer.</p><p>legacy elastic load balancers. produce 504 error code.</p><p><code>X-Forward-For</code> header can passing client ip addresses.</p><p>Read ELB FAQ for classic load balancers.</p><h3 id=listeners>Listeners
<a class=heading-link href=#listeners><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><blockquote><p>Every load balancer must have one or more listeners configured. A listener is a process that checks for connection requests—for example, a CNAME configured to the A record name of the load balancer. Every listener is configured with a protocol and a port (client to load balancer) for a front-end connection and a protocol and a port for the back-end (load balancer to Amazon EC2 instance) connection
&ndash; AWS certified solution architect official study guide</p></blockquote><h3 id=load-balancer-theory>load balancer theory
<a class=heading-link href=#load-balancer-theory><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ol><li>sticky session enable your users to stick to the same EC2 instance. real world user case is storing information locally to that instance.</li><li>cross zone load balancing enables you to load balance accross multiple availability zones.</li><li>path patterns allow you to direct traffic to different EC2 instances based on the URL contained in the request.</li></ol><h3 id=autoscaling>autoscaling
<a class=heading-link href=#autoscaling><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>there are 5 scaling options</p><ol><li>maintain current instance levels at all times.</li><li>scale manually.</li><li>scale based on a schedule</li><li>scale based on demand</li><li>user predictive scaling</li></ol><h2 id=application>Application
<a class=heading-link href=#application><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><h3 id=simple-queue-service-sqs>Simple Queue Service (SQS)
<a class=heading-link href=#simple-queue-service-sqs><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>a distributed queue system</p><p>SQS offers two types of queues</p><ul><li>standard queue</li><li>FIFO queue</li></ul><p>standard queue offered as a default type. the standard queue guarantees that a message is delievered at least once. standard queue has capability dealing with unlimited number of transactions per second.</p><p>standard queue provide best-effort ordering but it doesn&rsquo;t gurantee the order.</p><p>whereas</p><p>FIFO queue process a message exactly once. FIFO queues are limited to 300 transactions per second.</p><p>SQS is pull-based NOT pushed-based.</p><p>messages are 256 kb in size, and can be kept in the queue from 1 minute to 14 days. the default retention period is 4 days.</p><p>visibility timeout is the amount of time that the message is invisible in the SQS queue after a reader picks up that message. provided the job is processed before visibility timeout expires, the message will then be deleted from the queue. if the job is not processed within that time, the message will become visible again and another reader will process it. this could result in the same message being delivered twice.</p><p>SQS visibility timeout default is 30 seconds, max visibility timeout is 12 hours.</p><p>SQS retention period default is 4 days, min 60 seconds, max 14 days.</p><p>SQS long polling is a way to optimize your cost. while the short polling returns immediately (even if the message queue is empty), long polling doesn&rsquo;t return a response until a message arrives in the queue, or the long poll times out.</p><p>max long polling timeout is 20 seconds</p><h3 id=simple-work-flow-swf>Simple Work Flow (SWF)
<a class=heading-link href=#simple-work-flow-swf><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Amazon warehouse uses SWF</p><p>SWF is a web service that makes it esay to coordinate work accross distributed application components.</p><p>SQS has retention period of up to 14 days; with SWF, workflow executions can last up to 1 year.</p><p>SWF presents a task-oriented API</p><p>SWF ensures that a task is assigned only once and is never duplicated, whereas SQS, application might need to handle duplicated messages.</p><p>SWF has &ldquo;actors&rdquo;:</p><ol><li>workflow starters: an application that can initiate a workflow.</li><li>deciders: control the flow of activity tasks in a workflow execution.</li><li>activity workers: carry out the activity tasks.</li></ol><h3 id=simple-notification-service>Simple Notification Service
<a class=heading-link href=#simple-notification-service><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>instaneous, push-based delivery</li><li>simple APIs and easy integration with applications</li><li>flexible message delivery over multiple transport protocols</li></ul><p>What happens when you create a topic on Amazon SNS?</p><p>an amazon resource name is created</p><h3 id=sns-vs-sqs>SNS vs. SQS
<a class=heading-link href=#sns-vs-sqs><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>both are messaging services in AWS</li><li>SNS is push-based</li><li>SQS is poll based</li></ul><h3 id=elastic-transcoder>Elastic Transcoder
<a class=heading-link href=#elastic-transcoder><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>converting media files from original format to different formats.</p><h3 id=api-gateway-5-10marks>API Gateway (5-10marks)
<a class=heading-link href=#api-gateway-5-10marks><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>API Gateway is at high level</p><ul><li>API Gateway has caching capabilities to increase performance</li><li>API Gateway is low cost and scales automatically</li><li>one can throttle API Gateway to prevent attacks</li><li>enable CORS on API Gateway</li><li>CORS is enforced by client(mostly browser in modern days)</li></ul><h3 id=kinesis>Kinesis
<a class=heading-link href=#kinesis><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>First understand what is streamning data. streaming data is generated continuously by thousands of data sources, send in the data records simultaneously and in small sizes (we are talking about kb)</p><p>Amazon kinesis is a platform on AWS to send your streaming data to</p><p>there are 3 kinds of kinesis</p><ul><li>kinesis streams</li><li>kinesis firehose</li><li>kinesis analytics</li></ul><p>kinesis streams would <strong>persist</strong> data into shard 1 to 7 retention. the data could be consumed by ec2 instance.
shards can do 5 transactions per second for reads with maximum total data read rate of 2MB
shards can do 1000 records per second for writes, up to a maximum total data write rate of 1MB</p><p>data capacity of your stream is a function of the number of shards that you specify for the stream. the total capacity fo the stream is the sum of the capacities of its shards</p><p>kinesis firehose doesn&rsquo;t persist data. it can use an optional lambda function</p><p>kinesis analytics can analyze data on the fly</p><h3 id=web-identity-federation-and-amazon-cognito>Web Identity Federation and Amazon Cognito
<a class=heading-link href=#web-identity-federation-and-amazon-cognito><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>web identity federation allows users to authenticate with a web identity provider (google, facebook, amazon)</p><p>in order to go into details, we have to understand what is <code>user pool</code> and what is <code>identity pool</code>.</p><p><code>cognito user pool</code> are user directories used to manage sign-up and sign-in functionality for mobile and web applications. <code>cognito</code> acts as a broker between identity provider like Facebook and AWS. successful authentication generates a JSON Web token.</p><p><code>cognito identity pool</code> provide temporary AWS credentials/IAM rols</p><p><img src=/images/cognito.png alt=cognito></p><p><code>AWS cognito</code> can push silent SNS notifications accross platforms to update the user data</p><h2 id=security>Security
<a class=heading-link href=#security><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>in order to reduce security threats, we could take several methods</p><ul><li>ALB Blocking</li></ul><p>using ALB can block IPs at ALB, but EC2 security group will become pointless.</p><p><img src=/images/ALBBlocking.png alt=ALB></p><ul><li>NLB Blcoking</li></ul><p>using NLB, NLB will pass ip on to EC2, so will rely on EC2 to block IPs.</p><p><img src=/images/NLBBlocking.png alt=NLB></p><ul><li>WAF + CloudFront Blocking</li></ul><p>When using CloudFront, IP will become CloudFront&rsquo;s IP, EC2 doesn&rsquo;t know the real IP. So we need to setup a WAF in CloudFront to block IP.</p><p><img src=/images/WAFCloudFrontBlocking.png alt=WAFCloudFront></p><h2 id=kms>KMS
<a class=heading-link href=#kms><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>KMS will make it easier for you to manage keys for encrypting purposes.</p><h3 id=cmk-and-data-keys>CMK and Data Keys
<a class=heading-link href=#cmk-and-data-keys><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Customer Master Key are fundamental resources AWS KMS manages. CMK NEVER leaves KMS.
Whereas CMK can encrypt data keys, and Data Keys CAN leave KMS.</p><p><img src=/images/cmk_datakeys.png alt=kms></p><h3 id=data-keys-and-envelope-encryption>Data Keys and Envelope Encryption
<a class=heading-link href=#data-keys-and-envelope-encryption><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>AWS KMS uses envelope encryption to protect data.
The reason it&rsquo;s calling Envelope Encryption is because it uses more than one keys other than root key to protect data.</p><p>KMS creates a data key (plain text version). And CMK encrypts it under KMS (encrypted version). KMS will return plain text and encrypted versions of the data keys to you.</p><p>You will use plain text key to <strong>encrypt</strong> data. You will use encrypted key to retrieve plain text key.</p><h3 id=how-to-decrypt-text>how to decrypt text
<a class=heading-link href=#how-to-decrypt-text><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Your encrypted key and encrypted data will be stored together. When you want to decrypt, you have to provide the exact same encrypted data.</p><h2 id=cloudhsm>CloudHSM
<a class=heading-link href=#cloudhsm><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>What is CloudHSM and its features</li></ul><p>CloudHSM is a dedicated hardware security module.</p><p><img src=/images/cloudhsm.png alt=cloudhsm></p><ul><li>What is the typical structure</li></ul><p><img src=/images/cloudhsmStructure.png alt=cloudhsmStructure></p><h2 id=serverless>Serverless
<a class=heading-link href=#serverless><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><h3 id=lambda>Lambda
<a class=heading-link href=#lambda><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>Lambda scales out (not up) automatically. scale out here meaning 1 call triggers 1 lambda, 2 calls trigger 2 lambdas</li><li>Lambda functions are independent, 1 event = 1 function</li><li>Lambda is serverless</li><li>Arura, Lambda, S3, API gateway, etc are serverless</li><li>Lambda functions can trigger other lambda functions, 1 event can = x functions depending the design</li><li>AWS x-ray allows you to debug what is happening for serverless app.</li><li>Lambda can do thing in AWS globally.</li><li>events will trigger lambda, like upload to S3, SNS notifications, etc. know the triggers!</li></ul><p>serverless vs traditional</p><p><img src=/images/serverless.PNG alt=serverless></p><h3 id=serverless-miscellineous>serverless miscellineous
<a class=heading-link href=#serverless-miscellineous><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>Like any services in AWS, Lambda needs to have a role associated with it that provide credentials with rights to other services. This is exactly the same as needing a role on an EC2 instance to access S3 or DDB.</li><li>The exact ratio of cores to memory has varied over time for Lambda instances, however Lambda like EC2 and ECS supports hyper-threading on one or more virtual CPUs (if your code supports hyper-threading).</li></ul></div><footer><div class=comments><script>let getTheme=window.localStorage&&window.localStorage.getItem("colorscheme"),themeInParams="github-light";getTheme==null&&(themeInParams!==""&&themeInParams!=="auto"?getTheme=themeInParams:getTheme=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");let theme=getTheme==="dark"?"github-dark":"github-light",s=document.createElement("script");s.src="https://utteranc.es/client.js",s.setAttribute("repo","joejztang/joejztang.github.io"),s.setAttribute("issue-term","pathname"),s.setAttribute("theme",theme),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></footer></article></section></div><footer class=footer><section class=container>©
1990 -
2025
130l
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-YNPYVVT1S7"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-YNPYVVT1S7")}</script></body></html>