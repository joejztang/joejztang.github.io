<!doctype html><html lang=en><head><title>String interning in java and python · 130l</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="130l"><meta name=description content="
  什么是 string interning
  
    
    Link to heading
  

In computer science, string interning is a method of storing only one copy of each distinct string value, which must be immutable. Interning strings makes some string processing tasks more time- or space-efficient at the cost of requiring more time when the string is created or interned. The distinct values are stored in a string intern pool.
&mdash; from Wikipedia"><meta name=keywords content="blog,science,technology,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="String interning in java and python"><meta name=twitter:description content="什么是 string interning Link to heading In computer science, string interning is a method of storing only one copy of each distinct string value, which must be immutable. Interning strings makes some string processing tasks more time- or space-efficient at the cost of requiring more time when the string is created or interned. The distinct values are stored in a string intern pool.
— from Wikipedia"><meta property="og:url" content="https://joejztang.github.io/posts/string-interning-in-java-and-python/"><meta property="og:site_name" content="130l"><meta property="og:title" content="String interning in java and python"><meta property="og:description" content="什么是 string interning Link to heading In computer science, string interning is a method of storing only one copy of each distinct string value, which must be immutable. Interning strings makes some string processing tasks more time- or space-efficient at the cost of requiring more time when the string is created or interned. The distinct values are stored in a string intern pool.
— from Wikipedia"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-05-22T11:28:49+00:00"><meta property="article:modified_time" content="2018-05-22T11:28:49+00:00"><link rel=canonical href=https://joejztang.github.io/posts/string-interning-in-java-and-python/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.4b392a85107b91dbdabc528edf014a6ab1a30cd44cafcd5325c8efe796794fca.css integrity="sha256-SzkqhRB7kdvavFKO3wFKarGjDNRMr81TJcjv55Z5T8o=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/img/favicon.svg sizes=any><link rel=icon type=image/png href=/img/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/img/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://joejztang.github.io/>130l
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Posts</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://joejztang.github.io/posts/string-interning-in-java-and-python/>String interning in java and python</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2018-05-22T11:28:49Z>May 22, 2018
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
2-minute read</span></div><div class=categories><i class="fa-solid fa-folder" aria-hidden=true></i>
<a href=/categories/language-common/>Language Common</a></div></div></header><div class=post-content><h1 id=什么是-string-interning>什么是 string interning
<a class=heading-link href=#%e4%bb%80%e4%b9%88%e6%98%af-string-interning><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p><em>In computer science, string interning is a method of storing only one copy of each distinct string value, which must be immutable. Interning strings makes some string processing tasks more time- or space-efficient at the cost of requiring more time when the string is created or interned. The distinct values are stored in a string intern pool.</em></p><p>&mdash; from Wikipedia</p><p>它在其中提到了 string intern pool, 那什么是 string intern pool 呢?</p><p>想象一个大池子, 里面只能放<strong>不同</strong>的 string, 如果你有两个不同的 string object s1 和 s2, 他们内容都是"abc", 那么当创建完 s1之后, java 自动会在 string intern pool中注册, 那么当第二次看到你又创建一个s2是相同的内容的时候, java 自动把 string intern pool 中的那个 reference 拿给你.(大致上是这样, 细节有不同, 往下看)</p><h1 id=为什么用-string-interning-呢>为什么用 string interning 呢?
<a class=heading-link href=#%e4%b8%ba%e4%bb%80%e4%b9%88%e7%94%a8-string-interning-%e5%91%a2><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p>string interning 真的可以减少 object 的创建, 让程序变得 efficient. 同时, 如果 string 被 intern 了, 那么两个 string 可以用 &lsquo;==&rsquo; 来比较, 可以不用<code>equals()</code>来比较.</p><h1 id=什么时候会用到-string-interning-呢>什么时候会用到 string interning 呢?
<a class=heading-link href=#%e4%bb%80%e4%b9%88%e6%97%b6%e5%80%99%e4%bc%9a%e7%94%a8%e5%88%b0-string-interning-%e5%91%a2><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><ul><li>当用 constant 的方法创建 string, 比如<code>String s1 = "abc"</code>, 那么, java 自动为你<code>intern()</code></li><li>如果你用<code>new String()</code>的方法创建, 那你必须显性调用<code>intern()</code></li></ul><h1 id=给个例子>给个例子
<a class=heading-link href=#%e7%bb%99%e4%b8%aa%e4%be%8b%e5%ad%90><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>Test</span><span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>	</span><span style=color:#ff7b72>public</span><span style=color:#6e7681> </span><span style=color:#ff7b72>static</span><span style=color:#6e7681> </span><span style=color:#ff7b72>void</span><span style=color:#6e7681> </span><span style=color:#d2a8ff;font-weight:700>main</span>(String<span style=color:#ff7b72;font-weight:700>[]</span><span style=color:#6e7681> </span>args)<span style=color:#6e7681> </span>{<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		</span><span style=color:#8b949e;font-style:italic>// TODO Auto-generated method stub</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		</span>String<span style=color:#6e7681> </span>s1<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;abc&#34;</span>;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		</span>String<span style=color:#6e7681> </span>s2<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;abc&#34;</span>;<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		</span>String<span style=color:#6e7681> </span>s3<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span><span style=color:#ff7b72>new</span><span style=color:#6e7681> </span>String(<span style=color:#a5d6ff>&#34;abc&#34;</span>);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		</span>System.out.println(<span style=color:#a5d6ff>&#34;test string&#34;</span>);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		</span>System.out.println(s1<span style=color:#ff7b72;font-weight:700>==</span>s2);<span style=color:#6e7681> </span><span style=color:#8b949e;font-style:italic>// true</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		</span>System.out.println(s1<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>==</span><span style=color:#6e7681> </span>s3);<span style=color:#8b949e;font-style:italic>//false</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		</span>System.out.println(s2<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>==</span><span style=color:#6e7681> </span>s3);<span style=color:#8b949e;font-style:italic>//false</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		</span>System.out.println(<span style=color:#a5d6ff>&#34;===============================&#34;</span>);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		</span>System.out.println(<span style=color:#a5d6ff>&#34;test string creation interning&#34;</span>);<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		</span>s3<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#6e7681> </span>s3.intern();<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		</span>System.out.println(s1<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>==</span><span style=color:#6e7681> </span>s3);<span style=color:#6e7681> </span><span style=color:#8b949e;font-style:italic>// true</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		</span>System.out.println(s2<span style=color:#6e7681> </span><span style=color:#ff7b72;font-weight:700>==</span><span style=color:#6e7681> </span>s3);<span style=color:#6e7681> </span><span style=color:#8b949e;font-style:italic>// true</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>		
</span></span></span><span style=display:flex><span><span style=color:#6e7681>	</span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></div><h1 id=python-中的-string-intern>python 中的 string intern
<a class=heading-link href=#python-%e4%b8%ad%e7%9a%84-string-intern><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><ul><li>python 中用 constant 创建字符串, python 自动会 intern()</li><li>只包含下划线、数字、字母的字符串才会被intern (python-like string)</li><li>intern 以及 intern pool 只有在 compile time 的时候才会被操作. 如果在 runtime 对 string 有更改, string 不会自动被 intern, 即使 string 看起来是一样的.</li></ul><h1 id=关于数字常量池integer-pool>关于数字常量池(integer pool)
<a class=heading-link href=#%e5%85%b3%e4%ba%8e%e6%95%b0%e5%ad%97%e5%b8%b8%e9%87%8f%e6%b1%a0integer-pool><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p>数字从-128<del>127(还是0</del>127 忘了)java 认为比较常用, 所以当用 constant 的方法创建 <code>Integer</code> 时候, java 会自动把这个 object 注册到常量池.</p><p><strong>credit to</strong></p><ul><li><a href=https://blog.csdn.net/handsomekang/article/details/41170685 class=external-link target=_blank rel=noopener>什么是 string interning</a></li><li><a href=https://dzone.com/articles/string-interning-what-why-and class=external-link target=_blank rel=noopener>String interning what when and why</a></li><li><a href=http://www.cnblogs.com/Qian123/p/5707154.html class=external-link target=_blank rel=noopener>理解 string interning 及 String.intern() 的应用</a></li></ul></div><footer><div class=comments><script>let getTheme=window.localStorage&&window.localStorage.getItem("colorscheme"),themeInParams="github-light";getTheme==null&&(themeInParams!==""&&themeInParams!=="auto"?getTheme=themeInParams:getTheme=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");let theme=getTheme==="dark"?"github-dark":"github-light",s=document.createElement("script");s.src="https://utteranc.es/client.js",s.setAttribute("repo","joejztang/joejztang.github.io"),s.setAttribute("issue-term","pathname"),s.setAttribute("theme",theme),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></footer></article></section></div><footer class=footer><section class=container>©
1990 -
2025
130l
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-YNPYVVT1S7"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-YNPYVVT1S7")}</script></body></html>