<!doctype html><html lang=en><head><title>hexo 自动部署 本地自动执行 hexo g -d 的 python 脚本 · 130l</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="130l"><meta name=description content="用 hexo 一段时间了, 主要就是写写刷题心得和自己学习过程, 算是自己给自己写的 reference.
不幸的是前一段时间写了好多 draft, 然后其中一篇有 syntax error, 导致 hexo g 就是过不了. 在几十篇帖子里二分查找真是&rsquo;爽&rsquo;啊! 于是我就想到了很早之前就已经关注到的 hexo 自动部署 solution.
网上很容易找到的 solution 的思路都是把自己 source 里面的一些文件包括文章啊, 可能还有 theme 什么的放到 github 另一个 branch, 然后通过 webhook 监听, 如果有变动就执行 hexo g -d, 大概就是这样子. 由于我不太想把自己的源代码都放到另一个 branch 上(万一想加个密啥的呢), 所以这个 solution 显然不是我能用的 solution.
于是我在网上找, 发现linux 有个叫 crontab 的定时执行程序, 于是我的思路来了, 为什么不定时执行 python script 来执行 hexo g -d 这条命令呢? (后来在网上查到早有人已经写了, 但是没给放代码, 帖子后面会放上我写的 script)
这篇帖子我就来说说我写这个 script 的时候遇见的坑.

  思路
  
    
    Link to heading
  

通过 crontab 定时执行 python script, 达到自动执行 hexo g -d 的目的."><meta name=keywords content="blog,science,technology,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="hexo 自动部署 本地自动执行 hexo g -d 的 python 脚本"><meta name=twitter:description content="用 hexo 一段时间了, 主要就是写写刷题心得和自己学习过程, 算是自己给自己写的 reference.
不幸的是前一段时间写了好多 draft, 然后其中一篇有 syntax error, 导致 hexo g 就是过不了. 在几十篇帖子里二分查找真是’爽’啊! 于是我就想到了很早之前就已经关注到的 hexo 自动部署 solution.
网上很容易找到的 solution 的思路都是把自己 source 里面的一些文件包括文章啊, 可能还有 theme 什么的放到 github 另一个 branch, 然后通过 webhook 监听, 如果有变动就执行 hexo g -d, 大概就是这样子. 由于我不太想把自己的源代码都放到另一个 branch 上(万一想加个密啥的呢), 所以这个 solution 显然不是我能用的 solution.
于是我在网上找, 发现linux 有个叫 crontab 的定时执行程序, 于是我的思路来了, 为什么不定时执行 python script 来执行 hexo g -d 这条命令呢? (后来在网上查到早有人已经写了, 但是没给放代码, 帖子后面会放上我写的 script)
这篇帖子我就来说说我写这个 script 的时候遇见的坑.
思路 Link to heading 通过 crontab 定时执行 python script, 达到自动执行 hexo g -d 的目的."><meta property="og:url" content="https://joejztang.github.io/posts/hexo-%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2-%E6%9C%AC%E5%9C%B0%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8C-hexo-g-d-%E7%9A%84-python-%E8%84%9A%E6%9C%AC/"><meta property="og:site_name" content="130l"><meta property="og:title" content="hexo 自动部署 本地自动执行 hexo g -d 的 python 脚本"><meta property="og:description" content="用 hexo 一段时间了, 主要就是写写刷题心得和自己学习过程, 算是自己给自己写的 reference.
不幸的是前一段时间写了好多 draft, 然后其中一篇有 syntax error, 导致 hexo g 就是过不了. 在几十篇帖子里二分查找真是’爽’啊! 于是我就想到了很早之前就已经关注到的 hexo 自动部署 solution.
网上很容易找到的 solution 的思路都是把自己 source 里面的一些文件包括文章啊, 可能还有 theme 什么的放到 github 另一个 branch, 然后通过 webhook 监听, 如果有变动就执行 hexo g -d, 大概就是这样子. 由于我不太想把自己的源代码都放到另一个 branch 上(万一想加个密啥的呢), 所以这个 solution 显然不是我能用的 solution.
于是我在网上找, 发现linux 有个叫 crontab 的定时执行程序, 于是我的思路来了, 为什么不定时执行 python script 来执行 hexo g -d 这条命令呢? (后来在网上查到早有人已经写了, 但是没给放代码, 帖子后面会放上我写的 script)
这篇帖子我就来说说我写这个 script 的时候遇见的坑.
思路 Link to heading 通过 crontab 定时执行 python script, 达到自动执行 hexo g -d 的目的."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-08-02T22:41:08+00:00"><meta property="article:modified_time" content="2018-08-02T22:41:08+00:00"><link rel=canonical href=https://joejztang.github.io/posts/hexo-%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2-%E6%9C%AC%E5%9C%B0%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8C-hexo-g-d-%E7%9A%84-python-%E8%84%9A%E6%9C%AC/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.4b392a85107b91dbdabc528edf014a6ab1a30cd44cafcd5325c8efe796794fca.css integrity="sha256-SzkqhRB7kdvavFKO3wFKarGjDNRMr81TJcjv55Z5T8o=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/img/favicon.svg sizes=any><link rel=icon type=image/png href=/img/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/img/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://joejztang.github.io/>130l
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Posts</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://joejztang.github.io/posts/hexo-%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2-%E6%9C%AC%E5%9C%B0%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8C-hexo-g-d-%E7%9A%84-python-%E8%84%9A%E6%9C%AC/>hexo 自动部署 本地自动执行 hexo g -d 的 python 脚本</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2018-08-02T22:41:08Z>August 2, 2018
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
2-minute read</span></div><div class=categories><i class="fa-solid fa-folder" aria-hidden=true></i>
<a href=/categories/hexo/>Hexo</a></div></div></header><div class=post-content><p>用 hexo 一段时间了, 主要就是写写刷题心得和自己学习过程, 算是自己给自己写的 reference.</p><p>不幸的是前一段时间写了好多 draft, 然后其中一篇有 syntax error, 导致 <code>hexo g</code> 就是过不了. 在几十篇帖子里二分查找真是&rsquo;爽&rsquo;啊! 于是我就想到了很早之前就已经关注到的 hexo 自动部署 solution.</p><p>网上很容易找到的 solution 的思路都是把自己 source 里面的一些文件包括文章啊, 可能还有 theme 什么的放到 github 另一个 branch, 然后通过 webhook 监听, 如果有变动就执行 <code>hexo g -d</code>, 大概就是这样子. 由于我不太想把自己的源代码都放到另一个 branch 上(万一想加个密啥的呢), 所以这个 solution 显然不是我能用的 solution.</p><p>于是我在网上找, 发现linux 有个叫 <code>crontab</code> 的定时执行程序, 于是我的思路来了, 为什么不定时执行 python script 来执行 <code>hexo g -d</code> 这条命令呢? (后来在网上查到早有人已经写了, 但是没给放代码, 帖子后面会放上我写的 script)</p><p>这篇帖子我就来说说我写这个 script 的时候遇见的坑.</p><h1 id=思路>思路
<a class=heading-link href=#%e6%80%9d%e8%b7%af><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p>通过 <code>crontab</code> 定时执行 python script, 达到自动执行 <code>hexo g -d</code> 的目的.</p><h1 id=坑>坑
<a class=heading-link href=#%e5%9d%91><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><h2 id=file-还是-logger>file 还是 logger?
<a class=heading-link href=#file-%e8%bf%98%e6%98%af-logger><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>开始我在代码里面写的是, 打开一个 file, 然后执行 <code>generate</code> 函数和 <code>deploy</code> 函数, 把其中的<code>outs</code>和 <code>errs</code> 写到 file 里面. 但是这样在 <code>crontab</code> 里面执行几次发现 file 里面什么都没有. 我到现在也没有明白为什么东西写不到 file 里面. 但是 anyway, 我先一篇帖子说应该用 logger, 所以就用了 logger. 这样想要记录的内容就顺利的被记录了.</p><h2 id=hexo-not-a-file-or-directory-error>hexo not a file or directory error
<a class=heading-link href=#hexo-not-a-file-or-directory-error><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>这说明 python 根本没有找到 hexo 这个可执行的东西. 但是我明明在 terminal 就是能运行的. 原因是 <code>crontab</code> 不知道我们所处的环境, 它用的环境可能不够全. 所以在 terminal 里面执行 <code>echo $PATH</code>, copy 所有 path, 然后 <code>crontab -e</code> 加到最上头.</p><h2 id=不知道-crontab-执行没有>不知道 crontab 执行没有
<a class=heading-link href=#%e4%b8%8d%e7%9f%a5%e9%81%93-crontab-%e6%89%a7%e8%a1%8c%e6%b2%a1%e6%9c%89><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>有的时候不知道我是不是成功的执行了 crontab. 我就在 crontab 里面加上一条比如每分钟在同样的 log 文件里面写上"hello"的语句. 又或者 crontab 写的是对的, 脚本里面有错. 这里提醒一下, <strong>crontab 中执行脚本, 脚本里面的路径必须是绝对路径, 包括执行一些系统命令也要给绝对路径.</strong></p><h1 id=结语>结语
<a class=heading-link href=#%e7%bb%93%e8%af%ad><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><ul><li>script 的 <a href=https://github.com/joejztang/hexo-automation class=external-link target=_blank rel=noopener>地址</a> 奉上. 把 script 放在 hexo 主目录, 更改两个 const 就可以了.</li><li>不要忘记按照自己的喜好配置crontab. <strong>记得在 crontab tasks 前面加上 path, 避免运行不了 hexo.</strong></li></ul><p>have fun~</p><h1 id=credit>credit
<a class=heading-link href=#credit><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><ol><li><a href=https://serverfault.com/questions/778689/write-python-output-to-file-in-cronjob class=external-link target=_blank rel=noopener>write python output to file in cronjob</a></li><li><a href=https://www.jianshu.com/p/2f3e65e49d85 class=external-link target=_blank rel=noopener>Hexo 博客实现自动更新</a></li><li><a href=http://enjoycode.me/2017/12/04/macOS-crontab-configuration/ class=external-link target=_blank rel=noopener>macos crontab 定时任务配置</a></li><li><a href=http://codingpub.github.io/2016/10/27/OS-X-%E6%B7%BB%E5%8A%A0%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/ class=external-link target=_blank rel=noopener>osx 添加定时任务</a></li></ol></div><footer><div class=comments><script>let getTheme=window.localStorage&&window.localStorage.getItem("colorscheme"),themeInParams="github-light";getTheme==null&&(themeInParams!==""&&themeInParams!=="auto"?getTheme=themeInParams:getTheme=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");let theme=getTheme==="dark"?"github-dark":"github-light",s=document.createElement("script");s.src="https://utteranc.es/client.js",s.setAttribute("repo","joejztang/joejztang.github.io"),s.setAttribute("issue-term","pathname"),s.setAttribute("theme",theme),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></footer></article></section></div><footer class=footer><section class=container>©
1990 -
2025
130l
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-YNPYVVT1S7"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-YNPYVVT1S7")}</script></body></html>