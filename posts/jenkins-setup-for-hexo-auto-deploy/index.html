<!doctype html><html lang=en><head><title>jenkins setup for hexo auto deploy · 130l</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="130l"><meta name=description content="
  what did I do before
  
    
    Link to heading
  

this is what I did before. and with the capacity of vm being relative small (hexo is memory consuming!!!), have to recreate my vm.

  about aws
  
    
    Link to heading
  

I used aws as jenkins host. aws seems quicky to me because sometimes I got no permission sign in again to vm, even though I got the private key."><meta name=keywords content="blog,science,technology,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="jenkins setup for hexo auto deploy"><meta name=twitter:description content="what did I do before Link to heading this is what I did before. and with the capacity of vm being relative small (hexo is memory consuming!!!), have to recreate my vm.
about aws Link to heading I used aws as jenkins host. aws seems quicky to me because sometimes I got no permission sign in again to vm, even though I got the private key."><meta property="og:url" content="https://joejztang.github.io/posts/jenkins-setup-for-hexo-auto-deploy/"><meta property="og:site_name" content="130l"><meta property="og:title" content="jenkins setup for hexo auto deploy"><meta property="og:description" content="what did I do before Link to heading this is what I did before. and with the capacity of vm being relative small (hexo is memory consuming!!!), have to recreate my vm.
about aws Link to heading I used aws as jenkins host. aws seems quicky to me because sometimes I got no permission sign in again to vm, even though I got the private key."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-07-15T15:54:20+00:00"><meta property="article:modified_time" content="2019-07-15T15:54:20+00:00"><link rel=canonical href=https://joejztang.github.io/posts/jenkins-setup-for-hexo-auto-deploy/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.4b392a85107b91dbdabc528edf014a6ab1a30cd44cafcd5325c8efe796794fca.css integrity="sha256-SzkqhRB7kdvavFKO3wFKarGjDNRMr81TJcjv55Z5T8o=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/img/favicon.svg sizes=any><link rel=icon type=image/png href=/img/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/img/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://joejztang.github.io/>130l
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Posts</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://joejztang.github.io/posts/jenkins-setup-for-hexo-auto-deploy/>jenkins setup for hexo auto deploy</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2019-07-15T15:54:20Z>July 15, 2019
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
2-minute read</span></div><div class=categories><i class="fa-solid fa-folder" aria-hidden=true></i>
<a href=/categories/jenkins/>Jenkins</a></div></div></header><div class=post-content><h1 id=what-did-i-do-before>what did I do before
<a class=heading-link href=#what-did-i-do-before><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p><a href=https://joejztang.github.io/2019/02/22/%E8%BF%9F%E5%88%B0%E7%9A%84jenkins%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2/ class=external-link target=_blank rel=noopener>this</a> is what I did before. and with the capacity of vm being relative small (hexo is memory consuming!!!), have to recreate my vm.</p><h1 id=about-aws>about aws
<a class=heading-link href=#about-aws><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p>I used aws as jenkins host. aws seems quicky to me because sometimes I got no permission sign in again to vm, even though I got the private key.</p><p>I searched a little and found possible reasons including changing permission on <code>.ssh</code> folders, not setting up correct permission to pem key, etc.</p><p>but since I am a light user on aws, I decide to going to force way!</p><h1 id=permission-denied-publickey>permission denied (publickey)
<a class=heading-link href=#permission-denied-publickey><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p>above is the error I met most, every time I met this, I was so frustrated, because I know it would be long time to debug and reason of this issue is not guaranteed to be found.</p><p>luckily, I found <a href="https://www.youtube.com/watch?v=BDJJMqbla8s" class=external-link target=_blank rel=noopener>this</a>. this may not be an elegant way, but solve my issue.</p><h2 id=steps>steps
<a class=heading-link href=#steps><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ol><li>first using private key into your aws ec2 instance, change current user to <code>root</code>.</li><li>grant a password using <code>passwd root</code></li><li>back up <code>/etc/ssh/sshd_config</code> to <code>/etc/ssh/sshd_config.bak</code> using <code>cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak</code></li><li>edit <code>sshd_config</code> file</li></ol><ul><li><code>PermitRootLogin</code> to <code>yes</code> and comment out original line.</li><li><code>PasswordAuthentication</code> to <code>yes</code> and comment out original line.</li></ul><ol start=5><li>save and run <code>sshd -t</code>. if no output, then there is no error.</li><li>restart <code>sshd</code> using <code>service sshd restart</code></li></ol><p>by doing the above, every time I can guarantee login to root using password.</p><h1 id=how-to-do-auto-deploy-then>how to do auto deploy then.
<a class=heading-link href=#how-to-do-auto-deploy-then><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p>previously, I wrote bash script within jenkins directly. but since the user is <code>jenkins</code> and it lacks permission and environment to execute things, it is hard to keep doing so.</p><p>although it is worth mentioning by setting correct user to correct group, this issue can be solved, but I decide not to do this way.</p><p>I used brute force way, exporting essential <code>PATH</code> variables and execute things using user <code>root</code>.</p><p>for scripts, you can refer to <a href=https://github.com/joejztang/hexo-auto-deploy class=external-link target=_blank rel=noopener>this script</a>.</p><p>Now I can finally focus on writting blog again.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
1990 -
2025
130l
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>